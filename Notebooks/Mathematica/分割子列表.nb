(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     12274,        341]
NotebookOptionsPosition[     11256,        308]
NotebookOutlinePosition[     11524,        321]
CellTagsIndexPosition[     11481,        318]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["\:5206\:5272\:5b50\:5217\:8868", "Title",
 CellChangeTimes->{{3.6377573180793076`*^9, 3.63775736559193*^9}}],

Cell["\:6309\:6761\:4ef6\:5206\:5272\:5b50\:5217\:8868", "Section",
 CellChangeTimes->{{3.6377574082070875`*^9, 3.6377574120428057`*^9}}],

Cell[BoxData[
 RowBox[{"list", "=", 
  RowBox[{"{", 
   RowBox[{
   "4", ",", "11", ",", "15", ",", "8", ",", "1", ",", "10", ",", "5", ",", 
    "9", ",", "7", ",", "41", ",", "2", ",", "11", ",", "41", ",", "1", ",", 
    "2", ",", "8", ",", "2", ",", "6", ",", "1"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.6377574170993814`*^9, 3.6377574207629733`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "4", ",", "11", ",", "15", ",", "8", ",", "1", ",", "10", ",", "5", ",", 
   "9", ",", "7", ",", "41", ",", "2", ",", "11", ",", "41", ",", "1", ",", 
   "2", ",", "8", ",", "2", ",", "6", ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{3.6377574247948275`*^9, 3.6377577238537464`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"f", "[", "list_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"p", ",", "acc", ",", "len"}], "}"}], ",", 
    RowBox[{
     RowBox[{"p", "=", "list"}], ";", "\[IndentingNewLine]", 
     RowBox[{"acc", "=", 
      RowBox[{"TakeWhile", "[", 
       RowBox[{
        RowBox[{"Accumulate", "@", "p"}], ",", 
        RowBox[{
         RowBox[{"#", "<", "50"}], "&"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"len", "=", 
      RowBox[{"Length", "@", "acc"}]}], ";", 
     RowBox[{"Sow", "[", 
      RowBox[{"Take", "[", 
       RowBox[{"p", ",", "len"}], "]"}], "]"}], ";", 
     RowBox[{"Drop", "[", 
      RowBox[{"p", ",", "len"}], "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6377558122414527`*^9, 3.637755824186907*^9}, {
   3.6377559557360153`*^9, 3.6377560078144207`*^9}, {3.6377564235237665`*^9, 
   3.637756458239336*^9}, {3.6377565131241765`*^9, 3.637756550123439*^9}, 
   3.637756582639533*^9, {3.6377567129658833`*^9, 3.6377567524708405`*^9}, {
   3.6377569114554296`*^9, 3.6377569160956917`*^9}, {3.6377569466012893`*^9, 
   3.6377569687569733`*^9}, {3.637757045766473*^9, 3.6377570496712255`*^9}, {
   3.637757101238779*^9, 3.6377571050824995`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{"rest", ",", "parts0"}], "}"}], "=", 
  RowBox[{"Reap", "@", 
   RowBox[{"FixedPointList", "[", 
    RowBox[{"f", ",", "list"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.637755619622942*^9, 3.637755909415225*^9}, 
   3.6377559588632193`*^9, {3.6377560299310718`*^9, 3.637756052282905*^9}, {
   3.637756398327936*^9, 3.6377564144253483`*^9}, {3.637756487404975*^9, 
   3.6377565047612596`*^9}, {3.6377567314979987`*^9, 3.637756740452339*^9}, {
   3.6377567794659443`*^9, 3.637756783449764*^9}, {3.6377569204287596`*^9, 
   3.637756923154687*^9}, {3.6377569759350386`*^9, 3.63775697781437*^9}, {
   3.6377570638882833`*^9, 3.6377570710714207`*^9}, {3.637757436552702*^9, 
   3.6377574369319687`*^9}, 3.637757743990997*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "4", ",", "11", ",", "15", ",", "8", ",", "1", ",", "10", ",", "5", ",",
        "9", ",", "7", ",", "41", ",", "2", ",", "11", ",", "41", ",", "1", 
       ",", "2", ",", "8", ",", "2", ",", "6", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "5", ",", "9", ",", "7", ",", "41", ",", "2", ",", "11", ",", "41", ",",
        "1", ",", "2", ",", "8", ",", "2", ",", "6", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "41", ",", "2", ",", "11", ",", "41", ",", "1", ",", "2", ",", "8", ",",
        "2", ",", "6", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "11", ",", "41", ",", "1", ",", "2", ",", "8", ",", "2", ",", "6", ",", 
       "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "41", ",", "1", ",", "2", ",", "8", ",", "2", ",", "6", ",", "1"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"8", ",", "2", ",", "6", ",", "1"}], "}"}], ",", 
     RowBox[{"{", "}"}], ",", 
     RowBox[{"{", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"4", ",", "11", ",", "15", ",", "8", ",", "1", ",", "10"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"5", ",", "9", ",", "7"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"41", ",", "2"}], "}"}], ",", 
      RowBox[{"{", "11", "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"41", ",", "1", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"8", ",", "2", ",", "6", ",", "1"}], "}"}], ",", 
      RowBox[{"{", "}"}]}], "}"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.6377564897776546`*^9, 3.6377565203452873`*^9}, 
   3.637756551777609*^9, {3.6377567260881805`*^9, 3.6377567840541916`*^9}, {
   3.6377569178249288`*^9, 3.6377569238271637`*^9}, {3.6377569725106153`*^9, 
   3.6377569781586275`*^9}, {3.6377570515485506`*^9, 3.6377570723843594`*^9}, 
   3.6377571084999037`*^9, 3.6377574380517645`*^9, {3.637757724057892*^9, 
   3.6377577515263305`*^9}}],

Cell[BoxData[
 RowBox[{"parts1", "=", 
  RowBox[{
   RowBox[{"parts0", "[", 
    RowBox[{"[", "1", "]"}], "]"}], "//", "Most"}]}]], "Input",
 CellChangeTimes->{{3.6377570747680492`*^9, 3.637757083381137*^9}, {
  3.637757748454156*^9, 3.637757759335887*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"4", ",", "11", ",", "15", ",", "8", ",", "1", ",", "10"}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "9", ",", "7"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"41", ",", "2"}], "}"}], ",", 
   RowBox[{"{", "11", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"41", ",", "1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8", ",", "2", ",", "6", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.637757075940861*^9, 3.6377571094896035`*^9}, {
  3.6377577241979895`*^9, 3.6377577598602276`*^9}}],

Cell["\<\
f\:80af\:5b9a\:4e0d\:662f\:4e00\:4e2a\:597d\:51fd\:6570\:ff0c\:6bcf\:6b21\
\:90fd\:7528\:4e86\:4e00\:4e0bAccumulate[\:867d\:7136\:8fd9\:8d27\:5f88\:5feb]\
\:ff0c\:4e34\:65f6\:4e3a\:4e86\:8fdb\:5ea6\:5199\:7684\:ff0c\:8fd9\:662fMma\
\:7684\:51fd\:6570\:ff0c\:8111\:5b50\:4e0d\:597d\:4f7f\:7684\:65f6\:5019\:ff0c\
\:53ef\:4ee5\:5148\:7528\:628a\:95ee\:9898\:641e\:5b9a\:ff0c\:518d\:4f18\:5316\
\:4ee3\:7801\:3002\:641e\:7740\:641e\:7740\:ff0c\:6211\:7a81\:7136\:60f3\:5230\
\:65b0\:7248\:7684\:795e\:5668\:ff0c\:723d\
\>", "Text",
 CellChangeTimes->{{3.6377574498961287`*^9, 3.6377575004611144`*^9}, {
  3.637757574885786*^9, 3.6377575818887606`*^9}, {3.637757670350897*^9, 
  3.63775770899224*^9}}],

Cell[BoxData[
 RowBox[{"SequenceCases", "[", 
  RowBox[{"list", ",", 
   RowBox[{"list_", "/;", 
    RowBox[{
     RowBox[{"Total", "[", "list", "]"}], "<", "50"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.63775625943099*^9, 3.6377562773346725`*^9}, {
  3.637757814962802*^9, 3.6377578152640004`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"4", ",", "11", ",", "15", ",", "8", ",", "1", ",", "10"}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "9", ",", "7"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"41", ",", "2"}], "}"}], ",", 
   RowBox[{"{", "11", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"41", ",", "1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8", ",", "2", ",", "6", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.6377562687405777`*^9, 3.6377562780001316`*^9}, 
   3.6377575057688622`*^9}],

Cell["\:628a\:5217\:8868\:6309\:957f\:5ea6\:5217\:8868\:5206\:5272", "Section",
 CellChangeTimes->{{3.6377575152525682`*^9, 3.637757527708396*^9}}],

Cell[BoxData[
 RowBox[{"lengthList", "=", 
  RowBox[{"Length", "/@", "parts1"}]}]], "Input",
 CellChangeTimes->{{3.6377571779990883`*^9, 3.637757193280902*^9}, {
  3.637757754516457*^9, 3.637757763705951*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"6", ",", "3", ",", "2", ",", "1", ",", "3", ",", "4"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.6377571937912645`*^9, 3.6377575108664775`*^9, {3.6377577139747553`*^9, 
   3.6377577276274166`*^9}, 3.637757764221328*^9}],

Cell[BoxData[
 RowBox[{"parts", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "+", "1"}], ",", 
      RowBox[{"#", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "&"}], "/@", 
   RowBox[{"Partition", "[", 
    RowBox[{
     RowBox[{"Prepend", "[", 
      RowBox[{
       RowBox[{"Accumulate", "@", "lengthList"}], ",", "0"}], "]"}], ",", "2",
      ",", "1"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.637757562444976*^9, 3.6377576614876127`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"7", ",", "9"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"10", ",", "11"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"12", ",", "12"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"13", ",", "15"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"16", ",", "19"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.6377575714693522`*^9, 3.637757590580887*^9}, {
   3.6377576206717253`*^9, 3.637757623501728*^9}, 3.6377576620179863`*^9, {
   3.637757714116866*^9, 3.637757733360484*^9}, 3.637757768000989*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Take", "[", 
    RowBox[{"list", ",", "#"}], "]"}], "&"}], "/@", "parts"}]], "Input",
 CellChangeTimes->{{3.637757770741929*^9, 3.6377577851070957`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"4", ",", "11", ",", "15", ",", "8", ",", "1", ",", "10"}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "9", ",", "7"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"41", ",", "2"}], "}"}], ",", 
   RowBox[{"{", "11", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"41", ",", "1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8", ",", "2", ",", "6", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.6377577800995703`*^9, 3.6377577855404162`*^9}}],

Cell["", "Section"],

Cell[BoxData[
 RowBox[{"Notebook2GitHubPage", "[", 
  RowBox[{
   RowBox[{"EvaluationNotebook", "[", "]"}], ",", 
   RowBox[{"\"\<class\>\"", "\[Rule]", "\"\<Mathematica\>\""}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.6377621256145525`*^9, 3.637762141548817*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"nb1", "=", 
   RowBox[{"EvaluationNotebook", "[", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.638342984795518*^9, 3.6383429889204445`*^9}}],

Cell[BoxData[
 RowBox[{"<<", "MyGitHub`MyMathematicaBlog`"}]], "Input",
 CellChangeTimes->{{3.6383457535109816`*^9, 3.6383457665572405`*^9}}]
},
FrontEndVersion->"10.1 for Microsoft Windows (64-bit) (March 23, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 114, 1, 70, "Title"],
Cell[675, 23, 137, 1, 70, "Section"],
Cell[815, 26, 359, 7, 70, "Input"],
Cell[1177, 35, 328, 6, 70, "Output"],
Cell[1508, 43, 1258, 29, 70, "Input"],
Cell[2769, 74, 773, 14, 70, "Input"],
Cell[3545, 90, 2080, 51, 70, "Output"],
Cell[5628, 143, 257, 6, 70, "Input"],
Cell[5888, 151, 593, 16, 70, "Output"],
Cell[6484, 169, 707, 11, 70, "Text"],
Cell[7194, 182, 303, 7, 70, "Input"],
Cell[7500, 191, 570, 16, 70, "Output"],
Cell[8073, 209, 147, 1, 70, "Section"],
Cell[8223, 212, 209, 4, 70, "Input"],
Cell[8435, 218, 263, 6, 70, "Output"],
Cell[8701, 226, 552, 17, 70, "Input"],
Cell[9256, 245, 631, 17, 70, "Output"],
Cell[9890, 264, 200, 5, 70, "Input"],
Cell[10093, 271, 542, 15, 70, "Output"],
Cell[10638, 288, 19, 0, 70, "Section"],
Cell[10660, 290, 267, 6, 70, "Input"],
Cell[10930, 298, 178, 4, 70, "Input"],
Cell[11111, 304, 141, 2, 70, "Input"]
}
]
*)

(* End of internal cache information *)
